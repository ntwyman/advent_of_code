import pytest
from day2 import (
    invalid_codes,
    lower_limit,
    parse_lines,
    part2,
    part2_codes,
    upper_limit,
    part1,
)


TEST_INPUT = "11-22,95-115,998-1012,1188511880-1188511890,222220-222224,1698522-1698528,446443-446449,38593856-38593862,565653-565659,824824821-824824827,2121212118-2121212124"


def test_parse_lines():
    assert parse_lines(
        [
            TEST_INPUT,
        ]
    ) == [
        ("11", "22"),
        ("95", "115"),
        ("998", "1012"),
        ("1188511880", "1188511890"),
        ("222220", "222224"),
        ("1698522", "1698528"),
        ("446443", "446449"),
        ("38593856", "38593862"),
        ("565653", "565659"),
        ("824824821", "824824827"),
        ("2121212118", "2121212124"),
    ]


@pytest.mark.parametrize(
    "bound, lim", [("11", 1), ("95", 9), ("998", 10), ("1188511880", 11885)]
)
def test_lower_limit(bound: str, lim: int):
    assert lower_limit(bound) == lim


@pytest.mark.parametrize(
    "bound, lim", [("22", 2), ("115", 9), ("1012", 10), ("1188511890", 11885)]
)
def test_upper_limit(bound: str, lim: int):
    assert upper_limit(bound) == lim


@pytest.mark.parametrize(
    "range, codes",
    [
        (("11", "22"), [11, 22]),
        (
            ("95", "115"),
            [
                99,
            ],
        ),
        (
            ("998", "1012"),
            [
                1010,
            ],
        ),
        (
            ("1188511880", "1188511890"),
            [
                1188511885,
            ],
        ),
        (
            ("222220", "222224"),
            [
                222222,
            ],
        ),
        (("1698522", "1698528"), []),
        (
            ("446443", "446449"),
            [
                446446,
            ],
        ),
        (
            ("38593856", "38593862"),
            [
                38593859,
            ],
        ),
        (("565653", "565659"), []),
        (("824824821", "824824827"), []),
        (("2121212118", "2121212124"), []),
    ],
)
def test_invalid_codes(range: tuple[str, str], codes: list[int]):
    assert invalid_codes(range) == codes


def test_part1():
    assert part1([TEST_INPUT]) == 1227775554


@pytest.mark.parametrize(
    "range, codes",
    [
        (("11", "22"), [11, 22]),
        (
            ("95", "115"),
            [99, 111],
        ),
        (
            ("998", "1012"),
            [
                999,
                1010,
            ],
        ),
        (
            ("1188511880", "1188511890"),
            [
                1188511885,
            ],
        ),
        (
            ("222220", "222224"),
            [
                222222,
            ],
        ),
        (("1698522", "1698528"), []),
        (
            ("446443", "446449"),
            [
                446446,
            ],
        ),
        (
            ("38593856", "38593862"),
            [
                38593859,
            ],
        ),
        (
            ("565653", "565659"),
            [
                565656,
            ],
        ),
        (
            ("824824821", "824824827"),
            [
                824824824,
            ],
        ),
        (
            ("2121212118", "2121212124"),
            [
                2121212121,
            ],
        ),
    ],
)
def test_part2_codes(range: tuple[str, str], codes: list[int]):
    assert part2_codes(range) == codes


def test_part2():
    assert part2([TEST_INPUT]) == 4174379265
